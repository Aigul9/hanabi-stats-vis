{"version":3,"sources":["constants.js","main.js"],"names":["DB_PATH","DB_USER","DB_PASSWORD","viz","empty","limit","exist","checkbox","visible","item","classList","remove","add","notVisible","showError","text","document","getElementById","innerHTML","disable","disabled","enable","getInputs","querySelectorAll","map","input","checked","isChecked","includes","isPlayerSelected","radioPlayer","textPlayer","value","isLimitSelected","radioRecords","textRecords","createQuery","inputs","inputs_rel","match_q","return_q","query","forEach","index","slice","list","split","length","limitPerPlayer","Math","ceil","limit_q","player","join","console","log","isInt","num","Number","isInteger","draw","config","container_id","server_url","encrypted","server_user","server_password","labels","Player","caption","size","community","title_properties","relationships","REL","thickness","EASY","HARD","initial_cypher","NeoVis","default","render","e","querySelector","open","handleChange","textList","onClick","preventDefault","isPlayer","isLimit","isTypeChecked","onEnter","key","addEventListener","field"],"mappings":"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","file":"main.3262c5b1.js","sourceRoot":"..\\src","sourcesContent":["// export const DB_PATH = \"bolt://localhost:7687\",\r\n//   DB_USER = \"neo4j\",\r\n//   DB_PASSWORD = \"hanabi\";\r\n\r\nexport const DB_PATH = \"neo4j://abdf20aa.databases.neo4j.io\",\r\n  DB_USER = \"neo4j\",\r\n  DB_PASSWORD = \"B4uwAXSsSNmGXJjBlUVT5ejkJN3ym2HMxeZmNaTj3Co\";\r\n","\"use strict\";\r\n\r\nimport { DB_PATH, DB_USER, DB_PASSWORD } from \"./constants.js\";\r\n\r\nvar viz;\r\nconst empty = \"Field is empty.\",\r\n  limit = \"Incorrect number.\",\r\n  exist = \"Incorrect query.\",\r\n  checkbox = \"Select at least one option.\";\r\n\r\nfunction visible(item) {\r\n  item.classList.remove(\"not-visible\");\r\n  item.classList.add(\"visible\");\r\n}\r\n\r\nfunction notVisible(item) {\r\n  item.classList.add(\"not-visible\");\r\n}\r\n\r\nfunction showError(text) {\r\n  document.getElementById(\"message\").innerHTML = text;\r\n  visible(document.getElementById(\"message\"));\r\n}\r\n\r\nfunction disable(item) {\r\n  item.disabled = true;\r\n}\r\n\r\nfunction enable(item) {\r\n  item.disabled = false;\r\n}\r\n\r\nfunction getInputs() {\r\n  const inputs = document.querySelectorAll(\"input[type='checkbox']\");\r\n  return [...inputs].map((input) => input.checked);\r\n}\r\n\r\nfunction isChecked() {\r\n  return getInputs().includes(true);\r\n}\r\n\r\nfunction isPlayerSelected() {\r\n  const radioPlayer = document.getElementById(\"radioPlayer\"),\r\n    textPlayer = document.getElementById(\"textPlayer\").value;\r\n  return radioPlayer.checked && textPlayer !== null && textPlayer !== \"\";\r\n}\r\n\r\nfunction isLimitSelected() {\r\n  const radioRecords = document.getElementById(\"radioRecords\"),\r\n    textRecords = document.getElementById(\"textRecords\").value;\r\n  return radioRecords.checked && textRecords !== null && textRecords !== \"\";\r\n}\r\n\r\nfunction createQuery() {\r\n  const inputs = getInputs();\r\n  const inputs_rel = {\r\n    0: \"(p)-[r:REL]-(t), \",\r\n    1: \"(p)-[e:EASY]-(t), \",\r\n    2: \"(p)-[h:HARD]-(t), \",\r\n  };\r\n\r\n  var match_q = \"MATCH \",\r\n    return_q = \"RETURN p, t, \",\r\n    query = \"\";\r\n\r\n  // match clause\r\n  inputs.forEach((input, index) => {\r\n    if (input) match_q += inputs_rel[index];\r\n  });\r\n  match_q = match_q.slice(0, -2);\r\n\r\n  // return clause\r\n  inputs.forEach((input, index) => {\r\n    if (input) return_q += `${inputs_rel[index].slice(5, 6)}, `;\r\n  });\r\n  return_q = return_q.slice(0, -2);\r\n\r\n  if (isPlayerSelected()) {\r\n    const textPlayer = document.getElementById(\"textPlayer\").value;\r\n    // where clause\r\n    query = `${match_q} WHERE p.name = '${textPlayer}' ${return_q}`;\r\n  } else if (isLimitSelected()) {\r\n    const textRecords = document.getElementById(\"textRecords\").value;\r\n    const textList = document.getElementById(\"textList\").value;\r\n    var list = textList.split(\", \");\r\n    query = `${match_q} ${return_q} LIMIT ${textRecords}`;\r\n\r\n    if (list.length > 0 && list[0] !== \"\") {\r\n      const limitPerPlayer = Math.ceil(textRecords / list.length);\r\n      // limit clause\r\n      const limit_q = `LIMIT ${limitPerPlayer} UNION ALL `;\r\n\r\n      list = list.map(\r\n        (player) =>\r\n          `${match_q} WHERE p.name = '${player}' ${return_q} ${limit_q}`\r\n      );\r\n\r\n      query = list.join(\"\").slice(0, -11);\r\n    }\r\n  }\r\n\r\n  notVisible(document.getElementById(\"message\"));\r\n  console.log(query);\r\n  return query;\r\n}\r\n\r\nfunction isInt(num) {\r\n  return Number.isInteger(num) && num > 0 && num <= 1000;\r\n}\r\n\r\nfunction draw() {\r\n  var query = createQuery();\r\n  var config = {\r\n    container_id: \"viz\",\r\n    server_url: DB_PATH,\r\n    encrypted: \"ENCRYPTION_ON\",\r\n    server_user: DB_USER,\r\n    server_password: DB_PASSWORD,\r\n    labels: {\r\n      Player: {\r\n        caption: \"name\",\r\n        size: \"pagerank\",\r\n        community: \"community\",\r\n        title_properties: [\"name\", \"pagerank\", \"community\"],\r\n      },\r\n    },\r\n    relationships: {\r\n      REL: {\r\n        thickness: \"weight\",\r\n        caption: \"weight\",\r\n      },\r\n      EASY: {\r\n        thickness: \"weight\",\r\n        caption: \"weight\",\r\n      },\r\n      HARD: {\r\n        thickness: \"weight\",\r\n        caption: \"weight\",\r\n      },\r\n    },\r\n    initial_cypher: query,\r\n  };\r\n\r\n  try {\r\n    viz = new NeoVis.default(config);\r\n    viz.render();\r\n  } catch (e) {\r\n    console.log(\"Exception: \", e);\r\n    showError(exist);\r\n    return;\r\n  }\r\n\r\n  const details = document.querySelector(\"details\");\r\n  details.open = false;\r\n}\r\n\r\nfunction handleChange() {\r\n  const radioPlayer = document.getElementById(\"radioPlayer\");\r\n  const radioRecords = document.getElementById(\"radioRecords\");\r\n  var textPlayer = document.getElementById(\"textPlayer\");\r\n  var textRecords = document.getElementById(\"textRecords\");\r\n  var textList = document.getElementById(\"textList\");\r\n\r\n  if (radioPlayer.checked) {\r\n    disable(textRecords);\r\n    disable(textList);\r\n    enable(textPlayer);\r\n  } else if (radioRecords.checked) {\r\n    disable(textPlayer);\r\n    enable(textRecords);\r\n    enable(textList);\r\n  }\r\n}\r\n\r\nfunction onClick(e) {\r\n  e.preventDefault();\r\n\r\n  const isPlayer = isPlayerSelected(),\r\n    isLimit = isLimitSelected(),\r\n    isTypeChecked = isChecked(),\r\n    textRecords = document.getElementById(\"textRecords\").value;\r\n\r\n  if (!isPlayer && !isLimit) {\r\n    showError(empty);\r\n  } else if (isLimit && !isInt(+textRecords)) {\r\n    showError(limit);\r\n  } else if (!isTypeChecked) {\r\n    showError(checkbox);\r\n  } else {\r\n    draw();\r\n  }\r\n}\r\n\r\nfunction onEnter(e) {\r\n  if (e.key === \"Enter\") {\r\n    onClick(e);\r\n  }\r\n}\r\n\r\ndocument.getElementById(\"radioPlayer\").addEventListener(\"change\", handleChange);\r\ndocument\r\n  .getElementById(\"radioRecords\")\r\n  .addEventListener(\"change\", handleChange);\r\n\r\ndocument.querySelector(\".trigger\").addEventListener(\"click\", onClick);\r\n\r\nconst input = document.querySelectorAll(\"input\");\r\n\r\ninput.forEach((field) => field.addEventListener(\"keypress\", onEnter));\r\n\r\n// var details = document.querySelector(\"details\");\r\n\r\n// details.addEventListener(\"toggle\", function afterToggle() {\r\n//   if (details.open) {\r\n//     notVisible(document.getElementById(\"error\"));\r\n//   }\r\n// });\r\n"]}